[gd_scene load_steps=15 format=3 uid="uid://dtb34pld2df8t"]

[ext_resource type="Texture2D" uid="uid://bu3t1u42qw38y" path="res://Sprites/Test_Tile_Sprite_Holders/White_Square.png" id="1_rix20"]
[ext_resource type="Texture2D" uid="uid://v3tf11sn16to" path="res://icon.svg" id="2_ie74k"]
[ext_resource type="Texture2D" uid="uid://tlcfith2mkdc" path="res://Sprites/Test_Tile_Sprite_Holders/Black_Square.png" id="2_ix46s"]
[ext_resource type="Script" path="res://Combat/Enemy.gd" id="2_u72vy"]
[ext_resource type="Script" path="res://Combat/UI_Combat.gd" id="5_w577b"]
[ext_resource type="Texture2D" uid="uid://cdblvdggggc41" path="res://Sprites/blacksquare.png" id="6_6iyy6"]
[ext_resource type="Script" path="res://Combat/PlayerAttackPhase.gd" id="8_frq5w"]
[ext_resource type="Script" path="res://Combat/EnemyOnLoadData.gd" id="9_qfnky"]
[ext_resource type="Script" path="res://Combat/AimingArea2D.gd" id="9_qufre"]
[ext_resource type="Script" path="res://Combat/BowTiming.gd" id="9_v1hhq"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_yjvyp"]
size = Vector2(136.5, 56)

[sub_resource type="TileSetAtlasSource" id="TileSetAtlasSource_j1vcl"]
texture = ExtResource("6_6iyy6")
texture_region_size = Vector2i(128, 128)
0:0/0 = 0

[sub_resource type="TileSet" id="TileSet_v2ckg"]
tile_size = Vector2i(128, 128)
sources/0 = SubResource("TileSetAtlasSource_j1vcl")

[sub_resource type="RectangleShape2D" id="RectangleShape2D_ueekk"]
size = Vector2(126, 131)

[node name="AttackScene" type="Node2D"]

[node name="Enemy" type="Node2D" parent="."]
visible = false
position = Vector2(192, -267)
script = ExtResource("2_u72vy")

[node name="Sprite2D" type="Sprite2D" parent="Enemy"]
position = Vector2(-5, -2)
texture = ExtResource("2_ie74k")

[node name="Body" type="RigidBody2D" parent="Enemy" groups=["EnemyBody"]]
position = Vector2(-5, 63)
freeze = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="Enemy/Body"]
position = Vector2(0.75, -25)
shape = SubResource("RectangleShape2D_yjvyp")
debug_color = Color(0, 0.602169, 0.68733, 0.42)

[node name="Head" type="RigidBody2D" parent="Enemy" groups=["EnemyHead"]]
position = Vector2(-4, -7)
freeze = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="Enemy/Head"]
position = Vector2(2, -25.5)
shape = SubResource("RectangleShape2D_yjvyp")

[node name="UI" type="Node2D" parent="."]
position = Vector2(-84, 172)
script = ExtResource("5_w577b")

[node name="Display" type="TileMap" parent="UI"]
visible = false
position = Vector2(148, 15)
rotation = 1.57079
tile_set = SubResource("TileSet_v2ckg")
format = 2
layer_0/tile_data = PackedInt32Array(131069, 0, 0, 196605, 0, 0, 262141, 0, 0, 262142, 0, 0, 196606, 0, 0, 131070, 0, 0, 262143, 0, 0, 196607, 0, 0, 131071, 0, 0, 196608, 0, 0, 131072, 0, 0, 65536, 0, 0, 0, 0, 0, -65536, 0, 0, -131072, 0, 0, -196608, 0, 0, -131073, 0, 0, -65537, 0, 0, -1, 0, 0, -2, 0, 0, -65538, 0, 0, -131074, 0, 0, -131075, 0, 0, -65539, 0, 0, -3, 0, 0, 65533, 0, 0, 65534, 0, 0, 65535, 0, 0)

[node name="attack_button" type="Button" parent="UI"]
anchors_preset = 4
anchor_top = 0.5
anchor_bottom = 0.5
offset_left = -743.0
offset_top = 210.0
offset_right = -443.0
offset_bottom = 290.0
grow_vertical = 2
action_mode = 0
text = "Bow"
metadata/_edit_use_anchors_ = true

[node name="item_button" type="Button" parent="UI"]
offset_left = -67.0
offset_top = 210.0
offset_right = 233.0
offset_bottom = 290.0
action_mode = 0
text = "Item
"
metadata/_edit_use_anchors_ = true

[node name="run_button" type="Button" parent="UI"]
offset_left = 604.0
offset_top = 210.0
offset_right = 904.0
offset_bottom = 290.0
action_mode = 0
text = "Run
"
metadata/_edit_use_anchors_ = true

[node name="range_button" type="Button" parent="UI"]
offset_left = -82.0
offset_top = 208.0
offset_right = 268.0
offset_bottom = 296.0
text = "Range"

[node name="cursor" type="Node2D" parent="UI"]
position = Vector2(-589, 154)

[node name="Sprite2D" type="Sprite2D" parent="UI/cursor"]
scale = Vector2(0.5, 0.5)
texture = ExtResource("2_ix46s")

[node name="Camera2D" type="Camera2D" parent="."]

[node name="User" type="Node2D" parent="."]

[node name="Player" type="Node2D" parent="User"]
position = Vector2(-2, 120)
rotation = 1.57079

[node name="MainSprite" type="Sprite2D" parent="User/Player"]
texture = ExtResource("1_rix20")

[node name="AttackData" type="Node2D" parent="User/Player"]

[node name="PlayerPhase" type="Node2D" parent="User"]
position = Vector2(-140, -31)
script = ExtResource("8_frq5w")

[node name="Enemy Sprite Holder" type="Node2D" parent="User/PlayerPhase"]
visible = false
position = Vector2(137, -233)

[node name="BackGround" type="Sprite2D" parent="User/PlayerPhase/Enemy Sprite Holder"]
position = Vector2(0, -2.00001)
scale = Vector2(12.7656, 3.53125)
texture = ExtResource("2_ix46s")

[node name="EnemySprite" type="Sprite2D" parent="User/PlayerPhase/Enemy Sprite Holder"]
scale = Vector2(2.28125, 1.98438)
texture = ExtResource("1_rix20")

[node name="Player Sprite Holder" type="Node2D" parent="User/PlayerPhase"]
visible = false
position = Vector2(-431, 75)

[node name="PlayerSprite" type="Sprite2D" parent="User/PlayerPhase/Player Sprite Holder"]
scale = Vector2(2.60938, 2.54688)
texture = ExtResource("1_rix20")

[node name="AttackBox" type="Node2D" parent="User/PlayerPhase"]
visible = false
position = Vector2(-51, 43)

[node name="BoxSprite" type="Sprite2D" parent="User/PlayerPhase/AttackBox"]
position = Vector2(189, 301)
scale = Vector2(12.9063, 2.0625)
texture = ExtResource("6_6iyy6")

[node name="Aiming" type="Node2D" parent="User/PlayerPhase"]
position = Vector2(133, -2)

[node name="Area2D" type="Area2D" parent="User/PlayerPhase/Aiming"]
position = Vector2(0, -2)
script = ExtResource("9_qufre")

[node name="CollisionShape2D" type="CollisionShape2D" parent="User/PlayerPhase/Aiming/Area2D"]
position = Vector2(-1, -3.5)
shape = SubResource("RectangleShape2D_ueekk")

[node name="AimBox" type="Sprite2D" parent="User/PlayerPhase/Aiming"]
visible = false
position = Vector2(-1, -5)
texture = ExtResource("6_6iyy6")

[node name="Bow" type="Node2D" parent="User/PlayerPhase"]
script = ExtResource("9_v1hhq")

[node name="EnemyData" type="Node2D" parent="."]
script = ExtResource("9_qfnky")

[connection signal="range_attack" from="UI" to="User/PlayerPhase/Aiming/Area2D" method="_on_ui_range_attack"]
[connection signal="pressed" from="UI/attack_button" to="UI" method="_on_attack_button_pressed"]
[connection signal="pressed" from="UI/item_button" to="UI" method="_on_item_button_pressed"]
[connection signal="pressed" from="UI/run_button" to="UI" method="_on_run_button_pressed"]
[connection signal="pressed" from="UI/range_button" to="UI" method="_on_range_pressed"]
[connection signal="combat_phase_fail" from="User/PlayerPhase" to="User/PlayerPhase" method="combat_phase_fail_fc"]
[connection signal="combat_phase_success" from="User/PlayerPhase" to="User/PlayerPhase" method="combat_phase_success_fc"]
[connection signal="player_attack" from="User/PlayerPhase" to="UI" method="_on_range_pressed"]
[connection signal="_transition_" from="User/PlayerPhase/Aiming/Area2D" to="User/PlayerPhase" method="_ui_range_attack"]
[connection signal="body_entered" from="User/PlayerPhase/Aiming/Area2D" to="User/PlayerPhase/Aiming/Area2D" method="_on_body_entered"]
[connection signal="body_exited" from="User/PlayerPhase/Aiming/Area2D" to="User/PlayerPhase/Aiming/Area2D" method="_on_body_exited"]
